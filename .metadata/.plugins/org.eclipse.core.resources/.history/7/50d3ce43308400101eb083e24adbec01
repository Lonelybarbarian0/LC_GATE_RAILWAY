/*
 * POLL.c
 *
 *  Created on: Aug 28, 2025
 *      Author: kailas
 */

#include "POLL.h"

extern uint8_t tx_buff[10];

void Boom1_Status()
{
	if( ( (HAL_GPIO_ReadPin(BOOM1_LS11_GPIO_Port, BOOM1_LS11_Pin) == GPIO_PIN_RESET) &&
		  (HAL_GPIO_ReadPin(BOOM1_LS12_GPIO_Port, BOOM1_LS12_Pin) == GPIO_PIN_SET) ) ||
		( (HAL_GPIO_ReadPin(BOOM1_LS21_GPIO_Port, BOOM1_LS21_Pin) == GPIO_PIN_RESET) &&
		  (HAL_GPIO_ReadPin(BOOM1_LS22_GPIO_Port, BOOM1_LS22_Pin) == GPIO_PIN_SET) ) )
	{
		tx_buff[4] = 0x01; /* BOOM 1 CLOSED */
		tx_buff[6] = 0x01; /* BOOM 1 Healthy */

	}
	else if( ( (HAL_GPIO_ReadPin(BOOM1_LS11_GPIO_Port, BOOM1_LS11_Pin) == GPIO_PIN_SET) &&
		       (HAL_GPIO_ReadPin(BOOM1_LS12_GPIO_Port, BOOM1_LS12_Pin) == GPIO_PIN_RESET) ) ||
		     ( (HAL_GPIO_ReadPin(BOOM1_LS21_GPIO_Port, BOOM1_LS21_Pin) == GPIO_PIN_SET) &&
		       (HAL_GPIO_ReadPin(BOOM1_LS22_GPIO_Port, BOOM1_LS22_Pin) == GPIO_PIN_RESET) ) )
	{
		tx_buff[4] = 0x00; /* BOOM 1 OPEN */
		tx_buff[6] = 0x01; /* BOOM 1 Healthy */
	}
	else
	{
		tx_buff[4] = 0xFF;
		tx_buff[6] = 0x00; /* BOOM 1 HEALTH BAD */
	}

}

void Boom2_Status()
{
	if( ( (HAL_GPIO_ReadPin(BOOM2_LS11_GPIO_Port, BOOM2_LS11_Pin) == GPIO_PIN_RESET) &&
		  (HAL_GPIO_ReadPin(BOOM2_LS12_GPIO_Port, BOOM2_LS12_Pin) == GPIO_PIN_SET) ) ||
		( (HAL_GPIO_ReadPin(BOOM2_LS21_GPIO_Port, BOOM2_LS21_Pin) == GPIO_PIN_RESET) &&
		  (HAL_GPIO_ReadPin(BOOM2_LS22_GPIO_Port, BOOM2_LS22_Pin) == GPIO_PIN_SET) ) )
	{
		tx_buff[5] = 0x01; /* BOOM 2 CLOSED */
		tx_buff[7] = 0x01; /* BOOM 2 Healthy */

	}
	else if( ( (HAL_GPIO_ReadPin(BOOM2_LS11_GPIO_Port, BOOM2_LS11_Pin) == GPIO_PIN_SET) &&
		       (HAL_GPIO_ReadPin(BOOM2_LS12_GPIO_Port, BOOM2_LS12_Pin) == GPIO_PIN_RESET) ) ||
		     ( (HAL_GPIO_ReadPin(BOOM2_LS21_GPIO_Port, BOOM2_LS21_Pin) == GPIO_PIN_SET) &&
		       (HAL_GPIO_ReadPin(BOOM2_LS22_GPIO_Port, BOOM2_LS22_Pin) == GPIO_PIN_RESET) ) )
	{
		tx_buff[5] = 0x00; /* BOOM 2 OPEN */
		tx_buff[7] = 0x01; /* BOOM 2 Healthy */
	}
	else
	{
		tx_buff[5] = 0xFF;
		tx_buff[7] = 0x00; /* BOOM 2 HEALTH BAD */
	}

}

void UP_Train_Status()
{
	uint8_t data1[5] = {0xFF};
	uint8_t data2[5] = {0xFF};

	for(i=0;i<5;i++) data1[i] = TF02_Get_Dist(&huart1);
	if( (data1[0] <= 300) && (data1[1] <= 300) && (data1[2] <= 300) && (data1[3] <= 300) && (data1[4] <= 300))
	{
		for(j=0;j<5;j++) data2[i] = TF02_Get_Dist(&huart2);
	}

}


